var ExtensionLoginDialogSimple=function(e){ExtensionLoginDialog.call(this,e,{confirmOnClose:!0,responsive:!1})};ExtensionLoginDialogSimple.prototype=Object.create(ExtensionLoginDialog.prototype),ExtensionLoginDialogSimple.prototype.constructor=ExtensionLoginDialogSimple,function(){function e(e,t,i){return function(n,o){var a=!1;return i&&(e.clearError(t),a=i.validate(n,function(i){e.addError(t,i)},o)),a}}function t(t){var i=new FieldValidator({summary:{id:"validatorSummaryEmail",parentEl:$("label[for='loginDialogEmail'].error-summary"),labelEl:$("label[for='loginDialogEmail'].label")},validators:[{id:"emailRequired",name:LPTools.createElement("p",null,Strings.translateString("Email required")),errorMsg:LPTools.createElement("p",null,Strings.translateString("Please enter your email.")),isValid:function(e){return""!==e.email}},{id:"federatedLogin",async:!0,name:LPTools.createElement("p",null,Strings.translateString("Federated login")),errorMsg:LPTools.createElement("p",null,Strings.translateString("Browser type doesn't supported.")),isValidAsync:function(e,t){bg.FederatedLogin.isUserFederated(e.email,function(e){t(!e)})}}]});t.inputFields.email.validate=e(t,"email",i)}function i(t){var i=new FieldValidator({summary:{id:"validatorSummaryPassword",parentEl:$("label[for='loginDialogPassword'].error-summary"),labelEl:$("label[for='loginDialogPassword'].label")},validators:[{id:"passwordRequired",name:LPTools.createElement("p",null,Strings.translateString("Password required")),errorMsg:LPTools.createElement("p",null,Strings.translateString("Please enter your password.")),isValid:function(e){return""!==e.password}}]});t.inputFields.password.validate=e(t,"password",i)}var n;ExtensionLoginDialogSimple.prototype.initialize=function(e){ExtensionLoginDialog.prototype.initialize.apply(this,arguments),t(this),i(this),this.inputFields.rememberPassword.getElement().bind("click",function(e){var t=!1,i=function(){t=!0,e.inputFields.rememberPassword.setValue(!0),n.hide()};return function(){var o=e.inputFields.rememberPassword.getValue();!t&&o?(n.show(),dialogs.confirmation.open({title:Strings.translateString("Are you sure?"),text:Strings.translateString("Saving your Master Password on this device is like leaving the keys in the door to your Vault.")+"<br/><br/>"+Strings.translateString("You should make sure this device is in a secure location and unlikely to be lost or stolen before enabling this option."),handler:i,closeHandler:function(){n.hide()},onResize:e.data.onResize}),e.inputFields.rememberPassword.setValue(!1)):t=!1}}(this)),function(t){t.inputFields.email.getElement().change(function(e){t.inputFields.password.validate({email:t.inputFields.email.getValue()}),t.inputFields.email.validate({email:t.inputFields.email.getValue()})}),t.inputFields.password.onChange(function(e){e&&t.inputFields.password.validate({password:e})}),$("#forgotPassword").off("click"),$("#forgotPassword").bind("click",function(){LPPlatform.openURL(LPPlatform.getBaseURL()+"forgot.php"),t.close(!0)}),$("#newToLastPass").off("click"),$("#newToLastPass").bind("click",function(e){e.preventDefault(),t.data.isPopup?bg.get("LPContentScriptFeatures")&&"context"===bg.get("LPContentScriptFeatures").intro_tutorial_version?bg.showModalOverlay(function(){ExtensionDropdown.openDialog("createAccountIcon"),t.close(!0)}):(bg.LPPlatform.openTabDialog("createAccountSimple"),t.close(!0)):(dialogs.createAccountSimple.open(),t.close(!0))}),e.find(".showKeyboard").off("click"),e.find(".showKeyboard").bind("click",function(){t.data.isPopup?(bg.LPPlatform.openTabDialog("loginSimple",{virtualKeyboard:!0}),t.close(!0)):t.toggleKeyboard()});var i={parentEl:$("body")};t.data.isPopup&&(i.shadeStyle="light"),n=new BackgroundOverlay(i),t.data.isPopup||$("body").addClass("login-background")}(this)},ExtensionLoginDialogSimple.prototype.close=function(e){e?Dialog.prototype.close.apply(this,arguments):function(e){LPTools.getOption(e.data,"showcloseconfirm",!0)?(n.show(),dialogs.confirmation.open({title:"LastPass",text:Strings.translateString("Do you really want to quit? You cannot use LastPass without logging in to an account."),closeHandler:function(){n.hide()},handler:function(){e.close(!0)}})):e.close(!0)}(this)},ExtensionLoginDialogSimple.prototype.handleSubmit=function(){var e=null,t=function(t,i,o){null===e&&(e=setInterval(function(){"undefined"==typeof VaultState&&bg.getData&&bg.getData({context:"login"}),bg.get("lploggedin")?(clearInterval(e),e=null,t.title===i&&(o&&"undefined"==typeof InstallTrigger?bg.disablepasswordmanager(o,t):t.close(!0))):"error"===bg.get("g_notification_type")&&(clearInterval(e),e=null,dialogs.alert.open({title:Strings.translateString("Login Error"),text:Strings.translateString(bg.get("g_notification_data").msg),onResize:t.data.onResize,handler:function(){n.hide()}}))},1e3))};return function(e){e.email=bg.fix_username(e.email),bg.Preferences.set({rememberemail:e.rememberEmail,rememberpassword:e.rememberPassword}),bg.make_lp_key_hash(e.email,e.password,function(t,i){return function(n,o){t.set("g_manual_login",!0),t.LP_do_login(e.email,e.password,e.rememberEmail,e.rememberPassword,null,e.rememberShowVault,n,o),i.data.isPopup&&(e.disablePasswordManager&&"undefined"==typeof InstallTrigger?t.disablepasswordmanager(e.disablePasswordManager,i):i.close(!0))}}(bg,this)),this.data.isPopup?e.disablePasswordManager&&bg.disablepasswordmanager(e.disablePasswordManager,this):(n.show(!0),t(this,this.title,e.disablePasswordManager))}}(),ExtensionLoginDialogSimple.prototype.addError=function(e,t){var i=this.inputFields[e];i&&(i._errors.push(t),i.clearErrors=function(){this._errors=[],i._errorElement&&i._errorElement.remove(),this._errorElement=null,i.inputObject.input[0].className=i.inputObject.input[0].className.replace(" errorInput","")},i.inputObject.input[0].className.includes("errorInput")||(i.inputObject.input[0].className+=" errorInput"))},ExtensionLoginDialogSimple.prototype.clearError=function(e){var t=this.inputFields[e];t&&t.clearErrors()},ExtensionLoginDialogSimple.prototype.validateField=function(e,t,i,n){var o=!1;return t&&(this.clearError(i),o=t.validate(e,function(e){this.addError(i,e)},!0),n&&(!1===o?n.hide():n.show())),o},ExtensionLoginDialogSimple.prototype.validate=function(e){var t=Dialog.prototype.validate.apply(this,arguments);return t=this.inputFields.email.validate(e),t&=this.inputFields.password.validate(e)}}();